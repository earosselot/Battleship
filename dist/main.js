(()=>{var t={289:(t,e,s)=>{const i=s(507);t.exports=class extends i{constructor(t){super(t),this.tiles=this.makeArrayOfTiles()}setNextOutgoingAttack(){this.tiles=this.shuffleArray(this.tiles),this.nextOutgoingAttack=this.tiles.pop()}shuffleArray(t){return t.sort(((t,e)=>.5-Math.random())),t}makeArrayOfTiles(){let t=[];for(let e=0;e<100;e++)t.push(e);return t}}},998:t=>{function e(t,e){if(t.horizontal)for(let s=0;s<t.length;s++){let i=document.getElementById(`${e}-${t.position+s}`);0===s?i.classList.add("ship-left"):s===t.length-1&&i.classList.add("ship-right"),i.classList.add("tile-ship")}else for(let s=0;s<t.length;s++){let i=document.getElementById(`${e}-${t.position+10*s}`);0===s?i.classList.add("ship-top"):s===t.length-1&&i.classList.add("ship-bottom"),i.classList.add("tile-ship")}}function s(t,e){for(tileId of t.tilesShoted.water){let t=document.getElementById(`${e}-${tileId}`);t.classList.add("tile-water"),n(t)}}function i(t,e){for(tileId of t.tilesShoted.hit){let t=document.getElementById(`${e}-${tileId}`);t.classList.add("tile-hit"),n(t)}}function n(t){const e=document.createElement("div");e.classList.add("shoot"),t.innerHTML="",t.appendChild(e)}function r(t,e){if(t.horizontal)for(let s=0;s<t.length;s++){let i=document.getElementById(`${e}-${t.position+s}`);0===s?i.classList.add("ship-left"):s===t.length-1&&i.classList.add("ship-right"),i.classList.remove("tile-hit"),i.classList.add("tile-sunk")}else for(let s=0;s<t.length;s++){let i=document.getElementById(`${e}-${t.position+10*s}`);0===s?i.classList.add("ship-top"):s===t.length-1&&i.classList.add("ship-bottom"),i.classList.remove("tile-hit"),i.classList.add("tile-sunk")}}t.exports={createBoard:function(t){const e=document.getElementById(t);for(let s=0;s<100;s++){let i=document.createElement("div");i.setAttribute("id",`${t}-${s}`),i.classList.add("tile"),e.appendChild(i)}},renderPlayerBoard:function(t,n){!function(t,s){for(ship of Object.values(t.ships))e(ship,s)}(t,n),s(t,n),i(t,n)},renderEnemyBoard:function(t,e){s(t,e),i(t,e),function(t,e){let s=t.sunkShips();for(shipId of s)r(t.ships[shipId],e)}(t,e)}}},417:(t,e,s)=>{const i=s(390),n=s(289);t.exports=class{constructor(t,e,s,i){this.player1=this.createPlayer(t,e),this.player2=this.createPlayer(s,i),this.relatePlayers(),this.gameEnded=!1,this.winner=null}getGameEnded(){return this.gameEnded}getWinner(){return this.winner}createPlayer(t,e){if("human"===t)return new i(e);if("computer"===t)return new n(e);throw new Error('type of player not valid. Must be "human" or "computer"')}relatePlayers(){this.player1.setEnemy(this.player2),this.player2.setEnemy(this.player1)}gameTurn(){this.player1 instanceof i&&this.player2 instanceof n?(this.player1.play(),this.player2.setNextOutgoingAttack(),this.player2.play(),this.checkEndGame()):this.player1 instanceof n&&this.player2 instanceof n?(this.player1.setNextOutgoingAttack(),this.player1.play(),this.player2.setNextOutgoingAttack(),this.player2.play(),this.checkEndGame()):this.player1 instanceof i&&this.player2 instanceof i&&(this.player1.nextOutgoingAttack?this.player1.play():this.player2.nextOutgoingAttack&&(this.player2.play(),this.checkEndGame()))}checkEndGame(){(this.player1.gameboard.allShipsSank()||this.player2.gameboard.allShipsSank())&&(this.gameEnded=!0,this.setWinner())}setWinner(){this.player1.gameboard.allShipsSank()&&this.player2.gameboard.allShipsSank()?this.winner="tie":this.player1.gameboard.allShipsSank()?this.winner=this.player2:this.player2.gameboard.allShipsSank()&&(this.winner=this.player1)}}},498:(t,e,s)=>{const i=s(643);t.exports=class{constructor(){this.ships={},this.tilesWithShips={},this.tilesShoted={water:[],hit:[]}}addShip(t){let e=new i(t);return this.ships[e.getId()]=e,this.ships[e.getId()]}placeShip(t,e){let s=this.ships[t].setPosition(e),i={};for(const e of s){if(e in this.tilesWithShips)return!1;i[e]=t}return this.tilesWithShips={...this.tilesWithShips,...i},!0}receiveAttack(t){if(this.tilesShoted.water.includes(t)||this.tilesShoted.hit.includes(t))return!1;if(t in this.tilesWithShips){const e=this.tilesWithShips[t];return this.ships[e].hit(),this.tilesShoted.hit.push(t),!0}return this.tilesShoted.water.push(t),!0}allShipsSank(){for(const t of Object.values(this.ships))if(!t.isSunk())return!1;return!0}sunkShips(){let t=[];for(const e of Object.values(this.ships))e.isSunk()&&t.push(e.id);return t}}},390:(t,e,s)=>{const i=s(507);t.exports=class extends i{constructor(t){super(t)}setNextOutgoingAttack(t){this.nextOutgoingAttack=t}}},507:(t,e,s)=>{const i=s(498);t.exports=class{constructor(t){this.name=t,this.gameboard=new i,this.nextOutgoingAttack=null,this.enemy=null}createShips(){for(let t=2;t<6;t++)for(let e=1;e<7-t;e++)this.gameboard.addShip(t)}placeShips(){for(let t of Object.values(this.gameboard.ships)){let e=!1;for(;!e;){let s=this.generatePosition();this.randomRotation(t.id),e=this.gameboard.placeShip(t.id,s)}}}randomRotation(t){Math.random()<.5&&this.gameboard.ships[t].rotate()}generatePosition(){return Math.floor(100*Math.random())}setNextOutgoingAttack(){return null}getNextOutgoingAttack(){return this.nextOutgoingAttack}setEnemy(t){this.enemy=t}getEnemy(){return this.enemy}deleteEnemy(){this.enemy=null}play(){let t=this.getNextOutgoingAttack();this.enemy.gameboard.receiveAttack(t),this.nextOutgoingAttack=null}}},643:t=>{class e{static currentId=-1;constructor(t){if(t<=0||6<=t)throw new Error("Ship length must be between 1 and 5");this.id=this.setId(),this.length=t,this.hits=0,this.sunk=!1,this.horizontal=!0,this.position=-1}setId(){return e.currentId++,e.currentId}getId(){return this.id}hit(){return this.hits+=1,this}isSunk(){return this.hits===this.length?(this.sunk=!0,this.sunk):this.sunk}setPosition(t){if(t<0||t>99)throw new Error("position not valid");this.position=t;let e=this.setTiles();return this.position=Math.min(...e),e}setTiles(){let t=[];if(this.horizontal){const e=Math.floor(this.position/10);let s=0,i=1;for(;s<this.length;)Math.floor((this.position+s)/10)===e?t.push(this.position+s):(t.push(this.position-i),i++),s++}else{let e=0,s=1;for(;e<this.length;)this.position+10*e<100?t.push(this.position+10*e):(t.push(this.position-10*s),s++),e++}return t}rotate(){this.horizontal=!this.horizontal,this.setTiles()}}t.exports=e}},e={};function s(i){var n=e[i];if(void 0!==n)return n.exports;var r=e[i]={exports:{}};return t[i](r,r.exports,s),r.exports}(()=>{const t=s(417),e=s(998),i=new t("human","tony","computer","cpu2");function n(t){let s=t.path[0].id.split("-")[1];i.player1.setNextOutgoingAttack(s),i.gameTurn(),e.renderPlayerBoard(i.player1.gameboard,"P1Board"),e.renderEnemyBoard(i.player2.gameboard,"P1enemyBoard"),i.getGameEnded()&&console.log(i.winner.name),this.removeEventListener("click",n)}i.player1.createShips(),i.player1.placeShips(),i.player2.createShips(),i.player2.placeShips(),console.log(i),e.createBoard("P1Board"),e.createBoard("P1enemyBoard"),document.getElementById("P1enemyBoard").childNodes.forEach((t=>{t.addEventListener("click",n)}))})()})();
//# sourceMappingURL=main.js.map